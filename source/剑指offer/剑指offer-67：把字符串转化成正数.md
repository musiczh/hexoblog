## 题目：字符串转换成整数

写一个函数 StrToInt，实现把字符串转换成整数这个功能。不能使用 atoi 或者其他类似的库函数。

首先，该函数会根据需要丢弃无用的开头空格字符，直到寻找到第一个非空格的字符为止。

当我们寻找到的第一个非空字符为正或者负号时，则将该符号与之后面尽可能多的连续数字组合起来，作为该整数的正负号；假如第一个非空字符是数字，则直接将其与之后连续的数字字符组合起来，形成整数。

该字符串除了有效的整数部分之后也可能会存在多余的字符，这些字符可以被忽略，它们对于函数不应该造成影响。

注意：假如该字符串中的第一个非空格字符不是一个有效整数字符、字符串为空或字符串仅包含空白字符时，则你的函数不需要进行转换。

在任何情况下，若函数不能进行有效的转换时，请返回 0。

说明：

假设我们的环境只能存储 32 位大小的有符号整数，那么其数值范围为 [−231,  231 − 1]。如果数值超过这个范围，请返回  INT_MAX (231 − 1) 或 INT_MIN (−231) 。

## 思路历程

拿到这道题，一开始的思路就是按照他的条件，一个个地满足。

分析题目可以得到：

- 去掉开头空格
- 去掉尾部无用字符
- 获取中间有用数字，包括正负号
- 注意数字大小越界问题

> 这里的正负号没有理解好。题意是**从第一个符号开始计算数字**，如果类似+-11是不可以的，而我一开始的思路是直接把+号忽视，这样带来的问题还有+++2也是不可以的。所以要**理解好题意**。

这样的话貌似不难，按照题意要求来一步步实现即可。

我的思路是：

- 使用双指针来记录字符串参数中有效数字字符串的起始与终止位置
- 第一步使用循环找到起始位置
  - 如果遇到非法字符直接返回
  - 遇到合法数字停下
  - 遇到空格继续
- 第二步判断起始位置是否是正负符号
  - 如果是，需要再一次判断符号后是否有数字，如果没有则直接返回
  - 如果是负号，还需要设置标志
- 第三步找到终止位置，遇到非法字符停下
- 第四步判断字符串长度
  - 等于0直接返回
- 第五步使用计算累加得到结果
  - 如果在*10之前已经数字已经大于maxInt/10，或者加完之后变成负数，返回越界结果
- 第6步返回最终结果

这个思路虽然可以完成，但是缺点是：**复杂、步骤繁多、条件判断粒度小、容易漏掉其他细节**。时间复杂度为O(n),空间复杂度为O(1)，所以主要的优化是：代码规范性优化。

## 代码优化

- 第一步的任务是去除空格，所以并不需要在循环逻辑里进行判断是否遇到其他字符，只要不是空格就停下来即可。同时注意越界问题。
- 第二步并不需要在此判断正负号后续是否有数字。只需要判断第一个符号是否是正负号，剩下的交给后续的数字读取。如果读取到的数字长度是0，那么可以直接返回0。
- 第3、4、5可以进行合并。边寻找边界边累加。
- 判断是否超过int大小边界可以优化。只需要判断sum是否大于MaxInt/10或者sum==MaxInt/10且当前数字>7则可以判断越界。
- 可以使用-1或者1来进行进行正负号返回

## 总结

题目整体上难度不高，但是逻辑思路一开始没有想好，漏洞很多。后续出现问题则不断地通过增加判断条件来打补丁，这样是堵不住的，即使堵住了，也会造成代码异常复杂且繁琐。

需要先定好思路，从逻辑思路上去寻找严谨性，而不是从代码本身。注意看有一些步骤是否可以简化，合并等。

