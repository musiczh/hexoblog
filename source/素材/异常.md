## 异常

### 异常的概念

#### 关于代码的两个目标

- 结构不佳的代码不能运行。需要有一定的错误恢复能力，增强代码的健壮性。
- 要想创建健壮的系统，每个组件都必须是健壮的，需要有一定的错误报告机制

#### 背景

- c语言通过返回值来报告异常
- 需要在调用方法的时候顺便进行处理异常
- java通过把异常和正常的代码进行分离

#### 优点

异常往往能降低错误处理代码的复杂度。如果不使用异常，那么就必须检查特的错误，并在程序中的许多地方去处理它。而如果使用异常，那就不必在方法调用处进行检查，因为异常机制将保证能够捕获这个错误。理想情况下，只需在一个地方处理错误，即所谓的异常处理程序中。这种方式不仅节省代码，而且把“描述在正常执行过程中做什么事”的代码和“出了问题怎么办”的代码相分离。总之，与以前的错误处理方法相比，异常机制使代码的阅读、编写和调试工作更加井井有条



#### 异常处理机制前的世界

- 异常，是程序运行过程中出现的不可预料的特殊情况，如输入不合法或者环境出现问题等，我们需要向方法调用者告知这一点
- c语言通过使用返回值来把异常告知调用者，如返回-1即为异常
- 没有统一的处理机制，导致每次调用方法都需要进行条件判断，渐渐使得很多的程序员忽略这些异常，使得代码的健壮性下降【每次调用的时候都必须执行条件测试，以确定会产生何种结果。这使程序难以阅读并且有可能降低运行效率，因此程序员们既不愿意指出，也不愿意处理异常】
- 我们需要有一套一致错误处理和恢复机制，来让每个异常都不会有漏网之鱼，可以被调用者安全地处理

#### java异常机制

- 异常处理的一个重要目标就是把处理错误的代码同错误发生的地点相分离。这使你能在一段代码中专注于要完成的事情，至于如何处理错误，则放在另一段代码中完成。这样一来，主要代码就不会与错误处理逻辑混在一起，也更容易理解和维护。通过允许一个处理程序去处理多个出错点，异常处理还使得错误处理代码的数量趋于减少。
- 异常往往能降低错误处理代码的复杂度。如果不使用异常，那么就必须检查特定的错误，并在程序中的许多地方去处理它。而如果使用异常，那就不必在方法调用处进行检查，因为异常机制将保证能够捕获这个错误。理想情况下，只需在一个地方处理错误，即所谓的异常处理程序中。这种方式不仅节省代码，而且把“描述在正常执行过程中做什么事”的代码和“出了问题怎么办”的代码相分离。总之，与以前的错误处理方法相比，异常机制使代码的阅读、编写和调试工作更加井井有条

#### 支持java受检异常

- 【Java 的重要进步是统一了错误报告模式，所有错误都用异常来报告。这没有在 C++ 中发生，原因是为了向后兼容 C 】这是一套统一的机制，可以防止漏网之鱼，让程序更加安全
- 

#### 反对java受检异常

- 写一个简单的逻辑，也要写try catch语句
- 异常的代码和正常的代码是两个并行的世界，这会让代码看起来不连贯，而且代码随时都可能进入平行世界
- 开发异常的一个重要原则是：【只有在你知道如何处理的情况下才捕获异常】CLU 的设计师们认为：【我们觉得强迫程序员在不知道该采取什么措施的时候提供处理程序，是不现实的】
- 异常机制要解决的一个问题是不要在调用方法的时候进行条件判断，这样会非常麻烦，但是【要求程序员把异常处理程序的代码文本附接到会引发异常的调用上，这会降低程序的可读性，使得程序的正常思路被异常处理给破坏了。】
- Stroustrup 这样认为：【但是，这样一来几乎所有的函数都得提供异常说明了，也就都得重新编译，而且还会妨碍它同其他语言的交互。这样会迫使程序员违反异常处理机制的约束，他们会写欺骗程序来掩盖异常。这将给没有注意到这些异常的人造成一种虚假的安全感。】特别是最后一个：欺骗程序。因为程序员不知道怎么去处理异常，所以捕获之后不会进行任何处理，这样造成的后果就是，把异常“吃了”
- 受检异常机制主要是为了【不在于编译器是否会强制程序员去处理错误，而是要有一致的、使用异常来报告错误的模型；不在于什么时候进行检查，而是一定要有类型检查。也就是说，必须强制程序使用正确的类型，至于这种强制施加于编译时还是运行时，那倒没关系】【好的程序设计语言能帮助程序员写出好程序，但无论哪种语言都避免不了程序员用它写出坏程序。】
- 对测试人员的要求
- 全局异常处理